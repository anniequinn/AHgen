---
title: "Application Part 1 - Template"
author: 
 - Melissa Bedinger
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    theme: paper
    highlight: haddock
vignette: >
  %\VignetteIndexEntry{Vignette 7 - Application Part 1 - Template}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE, cache = TRUE, message = FALSE, warning = FALSE)

rm(list = ls()); cat("\014")

library(knitr)
library(tidyverse)
library(AHgen)
```
---

<style>
#TOC {
  background: url("images/hex.png");
  background-size: 230px;
  background-position-x: center;
  background-position-y: top;
  padding-top: 280px !important;
  background-repeat: no-repeat;
}
</style>

---

In this vignette, you will go through the steps of generating a template Urban Systems Abstraction Hierarchy in `AHgen`:

- Section 1 - Visualising the Abstraction Hierarchy
- Section 2 - Visualising and exploring results

To navigate to other vignettes, go to [Vignette 0 - Welcome to AHgen](Vignette-0---Welcome-to-AHgen.html).


## 0.1. Prepare the environment

```{r}
# Clear the RStudio environment
rm(list = ls()); cat("/014"); gc(verbose = TRUE)

# CTRL + SHIFT + F10 will detach any loaded packages and restart R

# Set the working directory to the folder where this script is saved
setwd(dirname(rstudioapi::getSourceEditorContext()$path)); getwd()

# If you are doing this for the first time
# install the package pacman which checks to see if a package is installed, and if not it attempts to install the package from CRAN and/or any other repository in the pacman repository list
# and install the package devtools which will allow you to download a package straight from GitHub i.e. if they are not yet on CRAN and/or the pacman repository list
# install.packages("devtools")
# install.packages("pacman")

# Ensure latest version of AHgen is installed
devtools::install_github("avisserquinn/AHgen@dev", dependencies = TRUE)

# If package has 'non-zero exit status', try re-installing devtools & rlang
# install.packages("devtools")
# install.packages("rlang")

# Load required packages
pacman::p_load(tidyverse, readxl, installr, janitor, vctrs, AHgen)
```


## 1.0. Read in data

```{r}
# Set name, version, location, and scenario
AH_name = "USAH"
AH_version = "3.0"
AH_location = "template"
AH_scenario = "baseline"

# Set directory for outputs
directory = "outputs/"

# Read in template USAH adjacency matrix
adjMat_template = 
  read_adjMat("inputs/USAH_3.0_template_baseline_adjMat_20230602.xlsx")

# Create template USAH vInfo (basic)
vInfo_template = 
  adjMat_template %>% select(level, levelName_full, levelName, Node)

# Read in template USAH vInfo (full)
vInfo_template_full = 
  read_xlsx("inputs/USAH_3.0_template_baseline_vInfo-full_20230621.xlsx")

# Read in OSMtidy-AHgen key for allocating OSMtidy descs to AHgen objects
key = 
  read_csv("inputs/OSM-AH-key_3.0_20230717.csv", show_col_types = FALSE)
```


## Last updated
This vignette is associated with `AHgen` v1.0.0, and was last updated by Melissa Bedinger on `r Sys.Date()`.