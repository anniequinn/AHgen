---
title: "Analyse - Additional functions"
author: 
 - Annie Visser-Quinn & Melissa Bedinger
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    theme: paper
    highlight: haddock
vignette: >
  %\VignetteIndexEntry{5 - Analyse - Additional functions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE, cache = TRUE, message = FALSE, warning = FALSE)

rm(list = ls()); cat("\014")

library(knitr)
library(tidyverse)
library(AHgen)
```

<style>
#TOC {
  background: url("images/hex.png");
  background-size: 230px;
  background-position-x: center;
  background-position-y: top;
  padding-top: 280px !important;
  background-repeat: no-repeat;
}
</style>
---

In this vignette, you will find out about analysing Abstraction Hierarchies with additional `AHgen` functions, building on the core functions from [Vignette 4](Vignette-4---Analyse---Core-functions.html):

- Section 1 - `apply_scenario()`
- Section 3
- `gen_newEdges()`
- `apply_geoData()`

- `calc_sensitivity()`
- `apply_sensitivity()`
- `summarise_confidence()`

- `compare_AH()`

- `export_AH()`


## 1. `apply_scenario`

The function `apply_scenario()` generates a new Abstraction Hierarchy by adjusting an existing Abstraction Hierarchy based on a new edge list. It has seven input arguments:

- *AH_input* - a standard `AHgen` output with eight list elements describing the vertices, network, and results
- *edgelist_scenario* - the new edge list of the Abstraction Hierarchy
- *proxyWeight* - a near-zero weight can sometimes be used to imitate removal of a vertex from the network, without actual removal (e.g. 0.000000001); this is optional and by default this is set to `proxyWeight = 0`
- *name* - the name of the system being modelled by this Abstraction Hierarchy, e.g. "USAH" for Urban Systems Abstraction Hierarchy
- *version* - the version of this Abstraction Hierarchy, e.g. "3.0"; by default this is set to `version = NULL`
- *location* - for applications of the Urban Systems Abstraction Hierarchy to specific geographical locations, e.g. "Bristol"; by default this is set to `location = NULL`
- *scenario* - for applications of the Urban Systems Abstraction Hierarchy to specific scenarios, e.g. "flood"; by default this is set to `scenario = NULL`

When applying the function:

- The *edgelist_scenario* must have used the `weight_edges()` and `weight_hangingVertices()` functions with `remove = FALSE`, or else any edges that are to be excluded from the original Abstraction Hierarchy should have a weight = 0. This enables a record of included and excluded vertices to be noted before removing edges with a weight = 0 and applying network analysis.
- The *edgelist_scenario* must have columns named *layer*, *from*, *to*, and *weight*.
- The *AH_input* must be a list which includes an element named *vIncluded* and an element named *vExcluded*.

<details><summary><span style = "color: #2196F3;">Example 1 - Apply a new edge list to modify an existing Abstraction Hierarchy</span></summary>
```{r}
# Read in AHgen output to be modified

# Read in new edge list

# Apply a new scenario
USAH_scenario = 
  apply_scenario(    
    AH_input = USAH_location_baseline, ## Specify USAH_input you want to modify
    edgelist_scenario = edgelist_location_flood, ## Specify edge list for new scenario
    name = "USAH", version = "3.0", location = location, scenario = scenario)
```
</details>


## 2. 


Next in [Vignette 6 - Visualise](Vignette-6---visualise.html), you will see how...

## Last updated
This vignette is associated with `AHgen` v1.0.0, and was last updated by Melissa Bedinger on `r Sys.Date()`.